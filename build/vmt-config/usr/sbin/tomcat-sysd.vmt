#!/bin/bash
DIR=$(dirname $0)
if [[ "$DIR" == "." ]]; then
	DIR=`pwd`
fi 

while true; do
	logger -t DTomcat "Starting Operations Manager"
	"$DIR/tomcat-sysd.local" "$@"
	logger -t DTomcat "Operations Manager terminated"
	if [ -f /tmp/vmt_oom ]; then
		rm -f /tmp/vmt_oom
		sleep 60
		logger -t Tomcat "The Operations Manager died from OutOfMemoryError. Restarting"
	else
		# Clean exit
		break
	fi
done
