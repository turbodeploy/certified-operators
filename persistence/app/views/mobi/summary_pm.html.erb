
<p id="top_section_label">Host Summary</p>

<hr />


<h4 style="margin:4px 0;">Host: <%= @pm_name %> </h4>

<h3 id="section_label">Resource Utilization</h3>

<table border="0" cellspacing="4">
  <tr>
    <th>Resource</th><th>&nbsp;</th><th>Avg Utilized</th><th>Peak Utilized</th>

    <% for stat in @stats.sort{|a,b| b.max_property_value.to_f <=> a.max_property_value.to_f} do %>
        <%# next if stat.property_type.downcase =~ /ballooning|swapping|q.*vcpu/ %>

      <tr>
        <td><%= prop_dname(stat.property_type) %></td>
        <td>&nbsp;</td>
        <td style="text-align: right;"><%= sprintf("%6.1f",stat.property_value.to_f*100)+'%'%></td>
        <td style="text-align: right;"><%= sprintf("%6.1f",stat.max_property_value.to_f*100)+'%'%></td>
      </tr>
    <% end %>
  </tr>
</table>


<h4 id="section_label" style="margin:4px 0;">Hosted VMs</h4>

<%
  keys = @grouped_stats.keys.sort{|a,b| @grouped_stats[a]['display_name'].to_s.downcase <=> @grouped_stats[b]['display_name'].to_s.downcase}

  unless keys.empty?
    names = @grouped_stats.values.last.keys.reject{|k| k.downcase =~ /ballooning|swapping|q.*vcpu|display_name/}
%>

<table border="0" cellspacing="4">
  <tr>
    <th>Virtual Machine</th><th style="text-align: right;"><%= names.collect{|n| n.gsub("Throughput","")}.join("</th><th style=\"text-align: right;\">") %></th>
  </tr>
  <% for key in keys do %>
    <tr>
      <td><%= link_to @grouped_stats[key]['display_name'], :controller => 'mobi', :action => 'summary_vm', :vm_uuid => key %>
        </td><td style="text-align: right;"><%= names.collect{|n| sprintf("%6.1f",@grouped_stats[key][n].to_f*100)+"%"}.join("</td><td style=\"text-align: right;\">") %></td>
    </tr>
  <% end %>
</table>

<%
  end
%>
