---
__inputs: []
__requires:
- type: grafana
  id: grafana
  name: Grafana
  version: 8.0.5
- type: panel
  id: graph
  name: Graph (old)
  version: ""
- type: datasource
  id: postgres
  name: PostgreSQL
  version: 1.0.0
- type: panel
  id: table
  name: Table
  version: ""
annotations:
  list:
  - builtIn: 1
    datasource: -- Grafana --
    enable: true
    hide: true
    iconColor: rgba(0, 211, 255, 1)
    name: Annotations & Alerts
    type: dashboard
description: This report shows daily average utilization measurements for the selected
  time range.. Averages are grouped into two sections. One rolled up for physical
  machines and another rolled up for virtual machines. Note that all physical and
  virtual machines are included. This information is useful as a top-level assessment
  of the overall average loading of your entire environment over time.
editable: false
gnetId: null
graphTooltip: 0
iteration: 1626807992515
links: []
panels:
- aliasColors: {}
  bars: false
  dashLength: 10
  dashes: false
  datasource: $DB
  description: Average utilization for physical machines over selected time period.
  fieldConfig:
    defaults:
      links: []
    overrides: []
  fill: 0
  fillGradient: 0
  gridPos:
    h: 9
    w: 12
    x: 0
    y: 0
  hiddenSeries: false
  id: 2
  legend:
    avg: false
    current: false
    max: false
    min: false
    show: true
    total: false
    values: false
  lines: true
  linewidth: 3
  nullPointMode: "null"
  options:
    alertThreshold: true
  percentage: false
  pluginVersion: 8.0.5
  pointradius: 2
  points: false
  renderer: flot
  seriesOverrides: []
  spaceLength: 10
  stack: false
  steppedLine: false
  targets:
  - format: time_series
    group: []
    metricColumn: none
    rawQuery: true
    rawSql: |-
      select DATE(metric."time") as "time", metric."type" as metric, avg(utilization)
      from metric
      join entity e on
          e.type = 'PHYSICAL_MACHINE'
          and e.oid = metric.entity_oid
      where
          ($__timeFrom(),$__timeTo()) OVERLAPS (e.first_seen, e.last_seen)
          and provider_oid isnull
          and metric.time BETWEEN timestamptz $__timeFrom() AND $__timeTo()
      group by 1, 2
      order by 1
    refId: A
    select:
    - - params:
        - current
        type: column
    table: metric
    timeColumn: '"time"'
    timeColumnType: timestamp
    where:
    - name: $__timeFilter
      params: []
      type: macro
  thresholds: []
  timeFrom: null
  timeRegions: []
  timeShift: null
  title: Physical Infrastructure Utilization Metrics
  tooltip:
    shared: true
    sort: 2
    value_type: individual
  type: graph
  xaxis:
    buckets: null
    mode: time
    name: null
    show: true
    values: []
  yaxes:
  - $$hashKey: object:410
    format: percentunit
    label: null
    logBase: 1
    max: null
    min: null
    show: true
  - $$hashKey: object:411
    format: short
    label: null
    logBase: 1
    max: null
    min: null
    show: true
  yaxis:
    align: false
    alignLevel: null
- datasource: $DB
  description: Percentage thresholds at which the color changes from Green to Yellow,
    and Yellow to Red
  fieldConfig:
    defaults:
      custom:
        align: null
        displayMode: auto
        width: 115
      mappings: []
      thresholds:
        mode: percentage
        steps:
        - color: green
          value: null
        - color: red
          value: 80
      unit: percentunit
    overrides:
    - matcher:
        id: byName
        options: CPU
      properties:
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: yellow
            value: 20
          - color: red
            value: 40
      - id: custom.displayMode
        value: color-background
    - matcher:
        id: byName
        options: Mem
      properties:
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 60
          - color: red
            value: 80
    - matcher:
        id: byName
        options: Ballooning
      properties:
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 30
          - color: red
            value: 60
    - matcher:
        id: byName
        options: Swapping
      properties:
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 10
          - color: red
            value: 25
    - matcher:
        id: byName
        options: IO Throughput
      properties:
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 20
          - color: red
            value: 40
    - matcher:
        id: byName
        options: Net Throughput
      properties:
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 20
          - color: red
            value: 40
    - matcher:
        id: byName
        options: CPU Ready Q
      properties:
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 3
          - color: red
            value: 10
    - matcher:
        id: byName
        options: VMem
      properties:
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 60
          - color: red
            value: 80
      - id: custom.displayMode
        value: color-background
    - matcher:
        id: byName
        options: VCPU
      properties:
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: percentage
          steps:
          - color: green
            value: null
          - color: '#EAB839'
            value: 20
          - color: red
            value: 40
  gridPos:
    h: 4
    w: 19
    x: 0
    y: 9
  id: 7
  options:
    showHeader: true
  pluginVersion: 8.0.5
  targets:
  - format: table
    group: []
    metricColumn: none
    rawQuery: true
    rawSql: |-
      SELECT  *
      FROM    (
              VALUES
              (.2, .6, .3, .1, .2, .2, .03, .2, .6),
              (.4, .8, .6, .25, .4, .4, .1, .4, .8)
              ) AS q ("CPU", "Mem", "Ballooning", "Swapping", "IO Throughput", "Net Throughput", "CPU Ready Q", "VCPU", "VMem")
    refId: A
    select:
    - - params:
        - execution_time
        type: column
    table: grafana
    timeColumn: '"time"'
    timeColumnType: timestamp
    where:
    - name: $__timeFilter
      params: []
      type: macro
  timeFrom: null
  timeShift: null
  title: Legend
  type: table
- datasource: -- Dashboard --
  description: Daily average for physical machines.
  fieldConfig:
    defaults:
      color:
        mode: thresholds
      custom:
        align: right
        displayMode: auto
      decimals: 2
      displayName: ""
      mappings: []
      thresholds:
        mode: absolute
        steps:
        - color: green
          value: null
        - color: red
          value: 80
      unit: percentunit
    overrides:
    - matcher:
        id: byName
        options: time
      properties:
      - id: displayName
        value: Date
      - id: unit
        value: 'time: YYYY-MM-DD'
    - matcher:
        id: byName
        options: CPU
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(41, 168, 36, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.2
          - color: rgba(245, 54, 54, 0.9)
            value: 0.4
    - matcher:
        id: byName
        options: MEM
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: custom.align
        value: null
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(50, 172, 45, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.6
          - color: rgba(245, 54, 54, 0.9)
            value: 0.8
    - matcher:
        id: byName
        options: BALLOONING
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: custom.align
        value: null
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(50, 172, 45, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.3
          - color: rgba(245, 54, 54, 0.9)
            value: 0.6
    - matcher:
        id: byName
        options: SWAPPING
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: custom.align
        value: null
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(50, 172, 45, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.1
          - color: rgba(245, 54, 54, 0.9)
            value: 0.25
    - matcher:
        id: byName
        options: IO_THROUGHPUT
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: custom.align
        value: null
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(50, 172, 45, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.2
          - color: rgba(245, 54, 54, 0.9)
            value: 0.4
    - matcher:
        id: byName
        options: NET_THROUGHPUT
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: custom.align
        value: null
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(50, 172, 45, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.2
          - color: rgba(245, 54, 54, 0.9)
            value: 0.4
    - matcher:
        id: byRegexp
        options: /Q.*_VCPU/
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: custom.align
        value: null
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(50, 172, 45, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.03
          - color: rgba(245, 54, 54, 0.9)
            value: 0.1
  gridPos:
    h: 12
    w: 24
    x: 0
    y: 13
  id: 4
  options:
    showHeader: true
  pluginVersion: 8.0.5
  targets:
  - panelId: 2
    refId: A
  timeFrom: null
  timeShift: null
  title: Physical Machine Summary
  transformations:
  - id: merge
    options:
      reducers: []
  type: table
- aliasColors: {}
  bars: false
  dashLength: 10
  dashes: false
  datasource: $DB
  description: Average utilization for virtual machines over selected time period.
  fieldConfig:
    defaults:
      links: []
    overrides: []
  fill: 0
  fillGradient: 0
  gridPos:
    h: 11
    w: 12
    x: 0
    y: 25
  hiddenSeries: false
  id: 3
  legend:
    avg: false
    current: false
    max: false
    min: false
    show: true
    total: false
    values: false
  lines: true
  linewidth: 3
  nullPointMode: "null"
  options:
    alertThreshold: true
  percentage: false
  pluginVersion: 8.0.5
  pointradius: 2
  points: false
  renderer: flot
  seriesOverrides: []
  spaceLength: 10
  stack: false
  steppedLine: false
  targets:
  - format: time_series
    group: []
    metricColumn: none
    rawQuery: true
    rawSql: |-
      select DATE(metric."time") as "time", metric."type" as metric, avg(utilization)
      from metric
      join entity e on
          metric.entity_oid = e.oid and
          e."type" = 'VIRTUAL_MACHINE' and
          e.environment = 'ON_PREM'
      where
          ($__timeFrom(),$__timeTo()) OVERLAPS (e.first_seen, e.last_seen)
          and provider_oid isnull
          and metric.time BETWEEN timestamptz $__timeFrom() AND $__timeTo()
      group by 1, 2
      order by 1
    refId: A
    select:
    - - params:
        - current
        type: column
    table: metric
    timeColumn: '"time"'
    timeColumnType: timestamp
    where:
    - name: $__timeFilter
      params: []
      type: macro
  thresholds: []
  timeFrom: null
  timeRegions: []
  timeShift: null
  title: Virtual Infrastructure Utilization Metrics
  tooltip:
    shared: true
    sort: 2
    value_type: individual
  type: graph
  xaxis:
    buckets: null
    mode: time
    name: null
    show: true
    values: []
  yaxes:
  - $$hashKey: object:317
    format: percentunit
    label: null
    logBase: 1
    max: null
    min: null
    show: true
  - $$hashKey: object:318
    format: short
    label: null
    logBase: 1
    max: null
    min: null
    show: true
  yaxis:
    align: false
    alignLevel: null
- datasource: -- Dashboard --
  description: Daily average for virtual machines.
  fieldConfig:
    defaults:
      color:
        mode: thresholds
      custom:
        align: ""
        displayMode: auto
      decimals: 2
      displayName: ""
      mappings: []
      thresholds:
        mode: absolute
        steps:
        - color: green
          value: null
        - color: red
          value: 80
      unit: percentunit
    overrides:
    - matcher:
        id: byName
        options: time
      properties:
      - id: displayName
        value: Date
      - id: unit
        value: 'time: YYYY-MM-DD'
    - matcher:
        id: byName
        options: VCPU
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(41, 168, 36, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.2
          - color: rgba(245, 54, 54, 0.9)
            value: 0.4
    - matcher:
        id: byName
        options: VMEM
      properties:
      - id: unit
        value: percentunit
      - id: decimals
        value: 2
      - id: custom.displayMode
        value: color-background
      - id: thresholds
        value:
          mode: absolute
          steps:
          - color: rgba(50, 172, 45, 0.97)
            value: null
          - color: rgba(237, 129, 40, 0.89)
            value: 0.6
          - color: rgba(245, 54, 54, 0.9)
            value: 0.8
  gridPos:
    h: 11
    w: 12
    x: 12
    y: 25
  id: 5
  options:
    showHeader: true
  pluginVersion: 8.0.5
  targets:
  - panelId: 3
    refId: A
  timeFrom: null
  timeShift: null
  title: Virtual Machine Summary
  transformations:
  - id: merge
    options:
      reducers: []
  type: table
refresh: false
schemaVersion: 30
style: dark
tags: []
templating:
  list:
  - description: null
    error: null
    hide: 2
    includeAll: false
    label: null
    multi: false
    name: DB
    options: []
    query: postgres
    queryValue: ""
    refresh: 1
    regex: ""
    skipUrlSync: false
    type: datasource
time:
  from: now-7d
  to: now
timepicker:
  refresh_intervals:
  - 10s
  - 30s
  - 1m
  - 5m
  - 15m
  - 30m
  - 1h
  - 2h
  - 1d
timezone: ""
title: Daily Infrastructure Average Stats vs. Thresholds
uid: host_vm_stats_thresholds
version: 2
