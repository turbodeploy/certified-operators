annotations:
  list:
  - builtIn: 1
    datasource: -- Grafana --
    enable: true
    hide: true
    iconColor: rgba(0, 211, 255, 1)
    name: Annotations & Alerts
    type: dashboard
description: Compare performance of dashboard query implementations
editable: false
gnetId:
graphTooltip: 0
iteration: 1610560253461
links: []
panels:
- aliasColors: {}
  bars: false
  dashLength: 10
  dashes: false
  datasource: $DB
  fieldConfig:
    defaults:
      custom: {}
      links: []
    overrides: []
  fill: 0
  fillGradient: 0
  gridPos:
    h: 12
    w: 23
    x: 0
    y: 0
  hiddenSeries: false
  id: 4
  legend:
    avg: false
    current: false
    max: false
    min: false
    show: true
    total: false
    values: false
  lines: true
  linewidth: 2
  nullPointMode: null as zero
  percentage: false
  pluginVersion: 7.1.1
  pointradius: 3
  points: true
  renderer: flot
  seriesOverrides: []
  spaceLength: 10
  stack: false
  steppedLine: false
  targets:
  - format: time_series
    group: []
    metricColumn: none
    rawQuery: true
    rawSql: |+
      SELECT
        timestamp '2019-12-31T05:00Z' + (end_time - start_time) as "time",
        label || ': ' || dashboard || '/' || name || case when coalesce(all_variable,True) then '[ALL]' else '' end as metric,
        execution_time
      FROM
        grafana
      where
        trial = $trial
        AND label = '$a_label'
        AND dashboard = any( array[ $dashboard ] )
        and query_type = any( array[ $type ] )
        and name = any( array [ $name ] )
        and ('$all' = 'Either' OR ('$all' = 'All Values') = all_variable)
      order by 1

    refId: A
    select:
    - - params:
        - current
        type: column
    table: metric
    timeColumn: '"time"'
    timeColumnType: timestamp
    where:
    - name: $__timeFilter
      params: []
      type: macro
  thresholds: []
  timeFrom:
  timeRegions:
  - $$hashKey: object:383
    colorMode: background6
    fill: true
    fillColor: rgba(234, 112, 112, 0.12)
    line: false
    lineColor: rgba(237, 46, 24, 0.60)
    op: time
  timeShift:
  title: Query time by interval - $a_label
  tooltip:
    shared: true
    sort: 2
    value_type: individual
  type: graph
  xaxis:
    buckets:
    mode: time
    name:
    show: true
    values: []
  yaxes:
  - $$hashKey: object:319
    format: ms
    label:
    logBase: 1
    max:
    min:
    show: true
  - $$hashKey: object:320
    format: short
    label:
    logBase: 1
    max:
    min:
    show: true
  yaxis:
    align: false
    alignLevel:
- aliasColors: {}
  bars: false
  dashLength: 10
  dashes: false
  datasource: $DB
  fieldConfig:
    defaults:
      custom: {}
      links: []
    overrides: []
  fill: 0
  fillGradient: 0
  gridPos:
    h: 12
    w: 23
    x: 0
    y: 12
  hiddenSeries: false
  id: 5
  legend:
    avg: false
    current: false
    max: false
    min: false
    show: true
    total: false
    values: false
  lines: true
  linewidth: 2
  nullPointMode: null as zero
  percentage: false
  pluginVersion: 7.1.1
  pointradius: 3
  points: true
  renderer: flot
  seriesOverrides: []
  spaceLength: 10
  stack: false
  steppedLine: false
  targets:
  - format: time_series
    group: []
    metricColumn: none
    rawQuery: true
    rawSql: |+
      SELECT
        timestamp '2019-12-31T05:00Z' + (end_time - start_time) as "time",
        label || ': ' || dashboard || '/' || name || case when coalesce(all_variable,True) then '[ALL]' else '' end as metric,
        execution_time
      FROM
        grafana
      where
        trial = $trial
        AND label = '$b_label'
        AND dashboard = any( array[ $dashboard ] )
        and query_type = any( array[ $type ] )
        and name = any( array [ $name ] )
        and ('$all' = 'Either' OR ('$all' = 'All Values') = all_variable)
      order by 1

    refId: A
    select:
    - - params:
        - current
        type: column
    table: metric
    timeColumn: '"time"'
    timeColumnType: timestamp
    where:
    - name: $__timeFilter
      params: []
      type: macro
  thresholds: []
  timeFrom:
  timeRegions:
  - $$hashKey: object:383
    colorMode: background6
    fill: true
    fillColor: rgba(234, 112, 112, 0.12)
    line: false
    lineColor: rgba(237, 46, 24, 0.60)
    op: time
  timeShift:
  title: Query time by interval - $b_label
  tooltip:
    shared: true
    sort: 2
    value_type: individual
  type: graph
  xaxis:
    buckets:
    mode: time
    name:
    show: true
    values: []
  yaxes:
  - $$hashKey: object:319
    format: ms
    label:
    logBase: 1
    max:
    min:
    show: true
  - $$hashKey: object:320
    format: short
    label:
    logBase: 1
    max:
    min:
    show: true
  yaxis:
    align: false
    alignLevel:
- datasource: $DB
  fieldConfig:
    defaults:
      custom:
        align:
      mappings:
      - from: ''
        id: 0
        operator: ''
        text: ''
        to: ''
        type: 1
      thresholds:
        mode: absolute
        steps:
        - color: green
          value:
        - color: red
          value: 80
      unit: none
    overrides:
    - matcher:
        id: byName
        options: execution_time
      properties:
      - id: unit
        value: ms
      - id: custom.width
        value: 117
    - matcher:
        id: byName
        options: dashboard
      properties:
      - id: custom.width
        value: 308
    - matcher:
        id: byName
        options: query_type
      properties:
      - id: custom.width
        value: 124
    - matcher:
        id: byName
        options: name
      properties:
      - id: custom.width
        value: 249
    - matcher:
        id: byName
        options: variable
      properties:
      - id: custom.width
        value: 239
    - matcher:
        id: byName
        options: id
      properties:
      - id: custom.width
        value: 143
      - id: links
        value:
        - targetBlank: true
          title: ''
          url: "http://xlr01.eng.turbonomic.com:3000/d/7Vo8bbiMk/query-details?orgId=1&var-DB=${DB}&var-id=${__data.fields[id]}\uFEFF"
    - matcher:
        id: byName
        options: time
      properties:
      - id: custom.width
        value: 200
    - matcher:
        id: byName
        options: interval
      properties:
      - id: custom.width
        value: 102
  gridPos:
    h: 9
    w: 23
    x: 0
    y: 24
  id: 2
  options:
    showHeader: true
    sortBy: []
  pluginVersion: 7.1.1
  targets:
  - format: table
    group: []
    metricColumn: none
    rawQuery: true
    rawSql: |
      SELECT
        id, 
        $__time(time),
        trial,
        label,
        (end_time - start_time)::interval as interval,
        extract('epoch' from (end_time - start_time)::interval) as interval_secs,
        execution_time,
        dashboard,
        query_type,
        name,
        variable
      FROM
        grafana
      where
        trial = $trial
        AND (label = '$a_label' OR label = '$b_label')
        AND dashboard = any( array[ $dashboard ] )
        and query_type = any( array[ $type ] )
        and name = any( array [ $name ] )
        and ('$all' = 'Either' OR ('$all' = 'All Values') = all_variable)
        ORDER BY dashboard, query_type, name, interval::interval, label
    refId: A
    select:
    - - params:
        - execution_time
        type: column
    table: grafana
    timeColumn: '"time"'
    timeColumnType: timestamp
    where: []
  timeFrom:
  timeShift:
  title: Performance Overview
  type: table
refresh: false
schemaVersion: 26
style: dark
tags: []
templating:
  list:
  - hide: 2
    includeAll: false
    label:
    multi: false
    name: DB
    options: []
    query: postgres
    queryValue: ''
    refresh: 1
    regex: ''
    skipUrlSync: false
    type: datasource
  - allValue:
    datasource: $DB
    definition: SELECT DISTINCT trial FROM grafana
    hide: 0
    includeAll: false
    label: trial
    multi: false
    name: trial
    options: []
    query: SELECT DISTINCT trial FROM grafana
    refresh: 2
    regex: ''
    skipUrlSync: false
    sort: 3
    tagValuesQuery: ''
    tags: []
    tagsQuery: ''
    type: query
    useTags: false
  - allValue:
    datasource: $DB
    definition: SELECT DISTINCT label FROM grafana
    hide: 0
    includeAll: false
    label: '"A" label'
    multi: false
    name: a_label
    options: []
    query: SELECT DISTINCT label FROM grafana
    refresh: 2
    regex: ''
    skipUrlSync: false
    sort: 5
    tagValuesQuery: ''
    tags: []
    tagsQuery: ''
    type: query
    useTags: false
  - allValue:
    datasource: $DB
    definition: SELECT DISTINCT label FROM grafana
    hide: 0
    includeAll: false
    label: '"B" label'
    multi: false
    name: b_label
    options: []
    query: SELECT DISTINCT label FROM grafana
    refresh: 2
    regex: ''
    skipUrlSync: false
    sort: 5
    tagValuesQuery: ''
    tags: []
    tagsQuery: ''
    type: query
    useTags: false
  - allValue: ''
    datasource: $DB
    definition: select dashboard from grafana
    hide: 0
    includeAll: true
    label:
    multi: true
    name: dashboard
    options: []
    query: select dashboard from grafana
    refresh: 2
    regex: ''
    skipUrlSync: false
    sort: 5
    tagValuesQuery: ''
    tags: []
    tagsQuery: ''
    type: query
    useTags: false
  - allValue: ''
    datasource: $DB
    definition: select query_type from grafana
    hide: 0
    includeAll: true
    label: 'Query Type '
    multi: true
    name: type
    options: []
    query: select query_type from grafana
    refresh: 2
    regex: ''
    skipUrlSync: false
    sort: 5
    tagValuesQuery: ''
    tags: []
    tagsQuery: ''
    type: query
    useTags: false
  - allValue: ''
    datasource: $DB
    definition: SELECT DISTINCT name FROM grafana where dashboard = any( array[ $dashboard
      ] ::text[]) and query_type = any ( array [ $type ]::text[] )
    hide: 0
    includeAll: true
    label: Panel or Var Name
    multi: true
    name: name
    options: []
    query: SELECT DISTINCT name FROM grafana where dashboard = any( array[ $dashboard
      ] ::text[]) and query_type = any ( array [ $type ]::text[] )
    refresh: 2
    regex: ''
    skipUrlSync: false
    sort: 5
    tagValuesQuery: ''
    tags: []
    tagsQuery: ''
    type: query
    useTags: false
  - allValue:
    hide: 0
    includeAll: false
    label: Var Values
    multi: false
    name: all
    options:
    - selected: false
      text: All Values
      value: All Values
    - selected: false
      text: Explicit Values
      value: Explicit Values
    - selected: true
      text: Either
      value: Either
    query: All Values,Explicit Values,Either
    queryValue: ''
    skipUrlSync: false
    type: custom
time:
  from: '2020-01-01T05:00:00.000Z'
  to: '2020-06-02T03:59:59.000Z'
timepicker:
  refresh_intervals:
  - 10s
  - 30s
  - 1m
  - 5m
  - 15m
  - 30m
  - 1h
  - 2h
  - 1d
timezone: ''
title: A/B Performance Comparison
uid: a_b_perf_comparison
